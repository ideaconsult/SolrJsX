<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<!--[if lt IE 7 ]><html class="ie ie6" lang="en" xmlns="http://www.w3.org/1999/xhtml"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en" xmlns="http://www.w3.org/1999/xhtml"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en" xmlns="http://www.w3.org/1999/xhtml"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<!--<![endif]-->

<head>
<script src="../../jquery-1.10.2.js"></script>
<script src="../../asSys/as-sys.js"></script>

<script src="../src/Core.js"></script>
<script src="../src/Management.js"></script>
<script src="../src/Configuring.js"></script>
<script src="../src/QueryingURL.js"></script>

<script src="../src/Faceting.js"></script>

<script lang="JavaScript">
  var SolrManager = a$(Solr.Management, Solr.QueryingURL),
      SolrFacet = a$(Solr.Faceting),
      
      Manager = new SolrManager({
        solrUrl : 'https://solr.ideaconsult.net/solr/enm_shard1_replica1/',
        connector: jQuery,
        onPrepare: function (settings) {  settings.url += "&wt=json&json.wrf=?"; },
        parameters: {
    			'facet' : true,
    			'facet.field' : ['unit'],
    			'facet.limit' : -1,
    			'facet.mincount' : 1,
          // https://cwiki.apache.org/confluence/display/solr/Collapse+and+Expand+Results
    			'fq' : "{!collapse field=s_uuid}",
    			'fl' : 'id,type_s,s_uuid,doc_uuid,topcategory,endpointcategory,guidance,substanceType,name,publicname,reference,reference_owner,interpretation_result,reference_year,content,owner_name,P-CHEM.PC_GRANULOMETRY_SECTION.SIZE,CASRN.CORE,CASRN.COATING,CASRN.CONSTITUENT,CASRN.ADDITIVE,CASRN.IMPURITY,EINECS.CONSTITUENT,EINECS.ADDITIVE,EINECS.IMPURITY,ChemicalName.CORE,ChemicalName.COATING,ChemicalName.CONSTITUENT,ChemicalName.ADDITIVE,ChemicalName.IMPURITY,TradeName.CONSTITUENT,TradeName.ADDITIVE,TradeName.IMPURITY,COMPOSITION.CORE,COMPOSITION.COATING,COMPOSITION.CONSTITUENT,COMPOSITION.ADDITIVE,COMPOSITION.IMPURITY',
    // 			'fl' : "id,type_s,s_uuid,doc_uuid,loValue,upValue,topcategory,endpointcategory,effectendpoint,unit,guidance,substanceType,name,publicname,reference,reference_owner,e_hash,err,interpretation_result,textValue,reference_year,content,owner_name",
    			'stats': true,			
    			'json.nl' : "map",
    			'rows' : 20,
    			'expand' : true,
    			'expand.rows' : 3
    		}
      }),
      
      Faceter = new SolrFacet ({
        field: "substanceType",
        facet: {
          'mincount': 2,
          'limit': 1,
        }
      });


  Manager.addListeners(Faceter);
  Manager.addParameter("q", "titanium");
  Manager.doRequest();
</script>
</head>
<html>
</html>
