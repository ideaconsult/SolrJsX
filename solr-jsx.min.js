!function(e){Solr={version:"0.15.1"},Solr.Management=function(t){if(e.extend(!0,this,e.common(t,this)),this.listeners={},this.response=null,this.error=null,this.pendingRequests=[],this.inRequest=!1,t&&t.solrUsername&&t.solrPassword){var r=btoa(t.solrUsername+":"+t.solrPassword);this.ajaxSettings.headers={Authorization:"Basic "+r}}},Solr.Management.prototype={__expects:["prepareQuery","parseQuery"],connector:null,solrUrl:"",servlet:"select",onError:function(e){window.console&&console.log&&console.log(e),401==e.status?$("<div>HTTP Error"+e.statusCode+" - Unauthorized: Access is denied due to invalid credentials.</div>").dialog():$("<div>HTTP Error: Unable to recieve content</div>").dialog()},onPrepare:function(e){},onSuccess:null,ajaxSettings:{async:!0,dataType:"json",method:"GET",processData:!1},doRequest:function(t,r){var n=this,a=null,i={};if(this.inRequest)this.pendingRequests.push(arguments);else{if(this.inRequest=!0,"function"==typeof t&&(r=t,t=n.servlet),"function"==typeof r||(e.each(n.listeners,function(t){!1===e.act(t,t.beforeRequest,n)&&(a=t)}),null===a))return i=e.extend(i,n.ajaxSettings,n.prepareQuery()),i.url=n.solrUrl+(t||n.servlet)+(i.url||""),i.error=n.onError,i.success=function(a){n.response=n.parseQuery(a),"function"==typeof r?r(n.response):(e.each(n.listeners,function(r){e.act(r,r.afterRequest,n.response,t)}),e.act(n,n.parseResponse,n.response,t),e.act(n,n.onSuccess))},i.complete=function(){n.inRequest=!1,n.pendingRequests.length>0&&n.doRequest.apply(n,n.pendingRequests.shift())},e.broadcast(n,"onPrepare",i),e.act(n,n.onPrepare,i),n.connector.ajax(i);e.act(a,n.onError,"Request cancelled",a)}},init:function(){var t=this;e.pass(t,Solr.Management,"init"),e.each(this.listeners,function(r){e.act(r,r.init,t)})},addListeners:function(e){for(var t,r=e,n=0,a=(r=arguments.length>1?arguments:Array.isArray(e)?e:[e]).length;n<a;++n)t=r[n],this.listeners[t.id]=t;return this},removeListener:function(e){return"objcet"==typeof e&&(e=e.id),delete this.listeners[e],this},removeManyListeners:function(t){if("function"!=typeof t)throw{name:"Enumeration error",message:"Attempt to select-remove listeners with non-function 'selector': "+t};var r=this;return e.each(r.listeners,function(e,n){t(e,n,r)&&delete r.listeners[n]}),r},enumerateListeners:function(t,r){if("function"!=typeof t)throw{name:"Enumeration error",message:"Attempt to enumerate listeners with non-function 'selector': "+t};e.each(this.listeners,function(e,n){t.call(e,e,n,r)})},getListener:function(e){return this.listeners[e]}},Solr.escapeValue=function(e){return"string"!=typeof e&&(e=e.toString()),!e.match(/[ :\/"]/)||e.match(/[\[\{]\S+ TO \S+[\]\}]/)||e.match(/^["\(].*["\)]$/)?e:'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"'},Solr.parseParameter=function(e){var t={},r=e.match(/^([^=]+)=(?:\{!([^\}]*)\})?(.*)$/);if(r){if(null!=r[2])for(var n;n=/([^\s=]+)=?(\S*)?/g.exec(r[2]);)t.domain===undefined&&(t.domain={}),null==n[2]?t.domain.type=n[1]:t.domain[n[1]]=n[2],r[2]=r[2].replace(n[0],"");t.name=r[1];var a=r[3].split(",");t.value=a.length>1?a:r[3]}return t},Solr.Configuring=function(t){this.parameterHistory=[],e.extend(!0,this,e.common(t,this)),this.resetParameters(),this.mergeParameters(t&&t.parameters)};var t=function(e){return e.match(/^(?:bf|bq|facet\.date|facet\.date\.other|facet\.date\.include|facet\.field|facet\.pivot|facet\.range|facet\.range\.other|facet\.range\.include|facet\.query|fq|fl|json\.query|json\.filter|group\.field|group\.func|group\.query|pf|qf|stats\.field)$/)};Solr.Configuring.prototype={addParameter:function(r,n,a){var i;if("object"!=typeof r?(i=r,r={name:r,value:n},null!=a&&(r.domain=a)):i=r.name,t(i))if(this.parameterStore[i]===undefined)this.parameterStore[i]=[r];else{var s=!1;if(e.each(this.parameterStore[i],function(t){s=s||e.equal(!0,r,t)}),s)return!1;this.parameterStore[i].push(r)}else this.parameterStore[i]=r;return r},findParameters:function(r,n){var a,i=[];return this.parameterStore[r]!==undefined&&("function"==typeof n?a=function(e,t){n(e,t)&&i.push(t)}:null==n?a=function(e,t){i.push(t)}:(("object"!=typeof n||n instanceof RegExp||Array.isArray(n))&&(n={value:n}),a=function(t,r){e.similar(t,n)&&i.push(r)}),e.each(t(r)?this.parameterStore[r]:[this.parameterStore[r]],a)),i},removeParameters:function(e,r){if(this.parameterStore[e]!==undefined){if("number"==typeof r?r=[r]:Array.isArray(r)||(r=this.findParameters(e,r)),t(e)&&r.length!=this.parameterStore[e].length){r.sort(function(e,t){return e<t?-1:e>t?1:0});for(var n=r.length-1;n>=0;--n)this.parameterStore[e].splice(r[n],1)}else delete this.parameterStore[e];return r.length}return!1},getParameter:function(e,r){var n=t(e);return this.parameterStore[e]===undefined?n&&null==r?[]:{name:e}:null!=r&&n?this.parameterStore[e][r]:this.parameterStore[e]},getAllValues:function(e){var r=null;return this.parameterStore[e]!==undefined&&(r=t(e)?this.parameterStore[e].map(function(e){return e.value}):this.parameterStore[e].value),r},mergeParameters:function(t){var r=this;e.each(t,function(e,t){"string"==typeof e?r.addParameter(Solr.parseParameter(t+"="+e)):r.addParameter(t,e)})},enumerateParameters:function(t,r){"boolean"!=typeof t&&(r=t,t=!0),e.each(this.parameterStore,function(n){t&&Array.isArray(n)?e.each(n,r):n!==undefined&&r(n)})},resetParameters:function(){this.parameterStore={}},pushParameters:function(t){this.parameterHistory.push(this.parameterStore),this.parameterStore="object"==typeof t?t:!1===t?{}:e.extend(!0,{},this.parameterStore)},popParameters:function(){var e=this.parameterStore;return this.parameterStore=this.parameterHistory.pop(),e}},function(e,t){e.Compatibility=function(e){t.extend(!0,this,e),this.store.root=this},e.Compatibility.prototype={store:{addByValue:function(e,t,r){return this.root.addParameter(e,t,r)},removeByValue:function(e,t){return this.root.removeParameters(e,indices)},find:function(e,t){return this.root.findParameters(e,neddle)}}}}(Solr,asSys),Solr.stringifyDomain=function(t){var r=[];return e.each(t.domain,function(e,t){r.push(("type"!==t?t+"=":"")+e)}),r.length>0?"{!"+r.join(" ")+"}":""},Solr.QueryingURL=function(e){};var r=function(t){if(Array.isArray(t))return t.join(",");if("object"!=typeof t)return t.toString();var r=[];return e.each(t,function(e,t){r.push(t+":"+Solr.escapeValue(e))}),r.join(" ")};Solr.QueryingURL.prototype={__expects:["enumerateParameters"],prepareParameter:function(e){var t=Solr.stringifyDomain(e);return e.value||t?e.name+"="+encodeURIComponent(t+r(e.value||"")):null},prepareQuery:function(){var e=[],t=this;return this.enumerateParameters(function(r){var n=t.prepareParameter(r);null!=n&&e.push(n)}),{url:"?"+e.join("&")}},parseQuery:function(e){return e}};var n=function(e){return e.match(/^(json\.nl|json\.wrf|q|wt|start)/)},a=function(e){var t=e.match(/^json\.?(.*)/);return t&&t[1]};Solr.QueryingJson=function(e){this.useBody=!e||"false"!==e.useBody},Solr.QueryingJson.prototype={__expects:["enumerateParameters"],useBody:!0,prepareQuery:function(){var t=[],r={params:{}},i=function(r){if(!n(r.name)){return"string"==typeof r.value?Solr.stringifyDomain(r)+r.value:r.domain!==undefined?e.extend({},r.value,{domain:r.domain}):r.value}t.push(Solr.QueryingURL.prototype.prepareParameter(r))};return this.enumerateParameters(!1,function(t){var n=Array.isArray(t)?t.map(i):i(t),s=Array.isArray(t)?t[0].name:t.name,o=a(s);n!=undefined&&(null!==o?e.path(r,o,n):r.params[s]=n)}),r=JSON.stringify(r),this.useBody?{url:"?"+t.join("&"),data:r,contentType:"application/json",type:"POST",method:"POST"}:(t.push(encodeURIComponent(r)),{url:"?"+t.join("&")})},parseQuery:function(t){if(t.responseHeader.params&&null!=t.responseHeader.params.json){var r=JSON.parse(t.responseHeader.params.json);e.extend(t.responseHeader.params,r,r.params),delete t.responseHeader.params.json}return t}},Solr.Persistency=function(t){e.extend(!0,this,t),this.storage={}},Solr.Persistency.prototype={__depends:[Solr.Configuring],persistentParams:[],addParameter:function(t,r,n){return e.pass(this,"addParameter",Solf.Configuring,t,r,n),t},removeParameters:function(t){e.pass(this,"removeParameters",Solf.Configuring,t)},onPrepare:function(e){}},Solr.Paging=function(t){e.extend(!0,this,e.common(t,this)),this.manager=null,this.currentPage=this.totalPages=this.totalEntries=null},Solr.Paging.prototype={pageSize:20,domain:null,init:function(e){this.manager=e,this.manager.addParameter("rows",this.pageSize)},setPage:function(e){return null!=this.totalPages&&("next"===e||">"===e?e=this.currentPage+1:"prev"===e||"previous"===e||"<"===e?e=this.currentPage-1:"first"===e||"start"===e?e=1:"last"===e||"end"===e?e=this.totalPages:"number"!=typeof e&&(e=parseInt(e)),!(e>this.totalPages||e<1||e===this.currentPage)&&(this.currentPage=e,this.manager.addParameter("start",(e-1)*this.pageSize,this.domain)))},page:function(e){return e!==undefined&&this.setPage(e),this.currentPage},previousPage:function(){return this.currentPage>1?this.currentPage-1:null},nextPage:function(){return this.currentPage<this.totalPages?this.currentPage+1:null},afterRequest:function(){var e=parseInt(this.manager.response.responseHeader&&this.manager.response.responseHeader.params&&this.manager.response.responseHeader.params.start||this.manager.getParameter("start").value||0);this.pageSize=parseInt(this.manager.response.responseHeader&&this.manager.response.responseHeader.params&&this.manager.response.responseHeader.params.rows||this.manager.getParameter("rows").value||this.pageSize),this.totalEntries=parseInt(this.manager.response.response.numFound),this.currentPage=Math.floor(e/this.pageSize)+1,this.totalPages=Math.ceil(this.totalEntries/this.pageSize)},clickHandler:function(e){var t=this;return function(){return t.setPage(e)&&t.manager.doRequest(),!1}}},Solr.Requesting=function(t){e.extend(!0,this,e.common(t,this)),this.manager=null},Solr.Requesting.prototype={resetPage:!0,customResponse:null,init:function(t){e.pass(this,Solr.Requesting,"init",t),this.manager=t},doRequest:function(){this.resetPage&&this.manager.addParameter("start",0),this.manager.doRequest(self.customResponse)},updateHandler:function(){var e=this;return function(){var t=e.addValue.apply(e,arguments);return t&&e.doRequest(),t}},clickHandler:function(e,t,r,n){var a=this;return function(i){return a.addValue(e,t,r,n)&&a.doRequest(),!1}},unclickHandler:function(e,t,r,n){var a=this;return function(i){return a.removeValue(e,t,r,n)&&a.doRequest(),!1}}},Solr.Spying=function(t){e.extend(!0,this,e.common(t,this)),this.manager=null},Solr.Spying.prototype={servlet:null,init:function(t){e.pass(this,Solr.Spying,"init",t),this.manager=t},doSpying:function(t,r){var n=this.manager;n.pushParameters(!0),"function"==typeof t?t(n):e.each(t,function(t,r){null==t?n.removeParameters(r):Array.isArray(t)?e.each(t,function(e){n.addParameter(r,e)}):"object"==typeof t?n.addParameter(t):n.addParameter(r,t)}),n.doRequest(this.servlet,r||this.onSpyResponse),n.popParameters()}},Solr.Delaying=function(e){this.delayTimer=null,this.delayed=e&&e.delayed||this.delayed},Solr.Delaying.prototype={delayed:300,doRequest:function(){var t=this,r=function(){e.pass(t,Solr.Delaying,"doRequest"),t.delayTimer=null};if(null==this.delayed||this.delayed<10)return r();null!=this.delayTimer&&clearTimeout(this.delayTimer),this.delayTimer=setTimeout(r,this.delayed)}},Solr.Patterning=function(t){this.valuePattern=t&&t.valuePattern||this.valuePattern;var r=this.fqRegExp.toString().replace(/^\/\^?|\$?\/$/g,""),n="^"+e.escapeRegExp(this.valuePattern.replace(/\{\{!?-\}\}/g,"-?").replace("{{v}}","__v__")).replace("__v__",r).replace("--?","-?").replace("--","");this.fqRegExp=new RegExp(n)},Solr.Patterning.prototype={valuePattern:"{{-}}{{v}}",fqValue:function(t,r){return this.valuePattern.replace("{{-}}",r?"-":"").replace("{{!-}}",r?"":"-").replace("{{v}}",e.pass(this,Solr.Patterning,"fqValue",t,r)).replace("--","")}},Solr.Texting=function(t){e.extend(!0,this,e.common(t,this)),this.manager=null},Solr.Texting.prototype={__expects:["doRequest"],domain:null,customResponse:null,escapeNeedle:!1,init:function(t){e.pass(this,Solr.Texting,"init",t),this.manager=t},addValue:function(t){var r=this.escapeNeedle&&t?t.replace(/\s+/g,"\\ "):t,n=this.manager.getParameter("q"),a=this.manager.addParameter("q",r,this.domain);return after=this.manager.getParameter("q"),a&&!e.equal(n,after)},clear:function(){return this.manager.removeParameters("q")},removeValue:function(){this.clear()},clickHandler:function(e){var t=this;return function(){return el||(el=this),t.addValue("function"==typeof el.val?el.val():el.value)&&t.doRequest(),!1}}};var i={prefix:null,sort:null,limit:null,offset:null,mincount:null,missing:null,method:null,"enum.cache.minDf":null},s=/^\s*\(\s*|\s*\)\s*$/g,o=/^([^()]+)\(([^)]+)\)$/g;Solr.facetValue=function(e){return Array.isArray(e)?1==e.length?Solr.escapeValue(e[0]):"("+e.map(function(e){return Solr.escapeValue(e)}).join(" ")+")":Solr.escapeValue(e)},Solr.parseFacet=function(e){var t,r,n=e.length;if(e=e.replace(s,""),r=n>e.length,t=e.replace(/\\"/g,"%0022").match(/[^\s:\/"]+|"[^"]+"/g),!r&&t.length>1)return null;for(var a=0,i=t.length;a<i;++a)t[a]=t[a].replace(/^"|"$/g,"").replace("%0022",'"');return i>1?t:t[0]},Solr.facetStats=function(t,r,n){t.addParameter("stats",!0);var a={};e.each(n,function(e,t){var n=e.match(o);if(n){var i=n[2],s=n[1],u=a[i];u===undefined&&(a[i]=u={},u.tag=r),u[s]=!0,u.key=t}}),e.each(a,function(e,r){t.addParameter("stats.field",r,e)})},Solr.Faceting=function(t){this.id=this.field=null,e.extend(!0,this,e.common(t,this)),this.manager=null,this.multivalue||(this.aggregate=!1),this.jsonLocation||(this.jsonLocation="json.facet."+this.id),this.facet=t&&t.facet||{},this.fqRegExp=new RegExp("^-?"+this.field+":([^]+)$")},Solr.Faceting.prototype={multivalue:!1,aggregate:!1,exclusion:!1,domain:null,nesting:null,useJson:!1,jsonLocation:null,domain:null,statistics:null,init:function(t){e.pass(this,Solr.Faceting,"init",t),this.manager=t;var r=null;if(this.nesting&&(this.facet.domain=e.extend(this.facet.domain,{blockChildren:this.nesting})),this.exclusion&&(this.domain=e.extend(this.domain,{tag:this.id+"_tag"}),r=this.id+"_tag"),this.useJson){var n={type:"terms",field:this.field,mincount:1,limit:-1};this.statistics&&(n.facet=this.statistics),null!=r&&(n.domain={excludeTags:r}),this.fqName="json.filter",this.manager.addParameter(this.jsonLocation,e.extend(!0,n,this.facet))}else{var a=this,s=e.extend(!0,{},i),o={key:this.id};null!=r&&(o.ex=r),this.fqName="fq",this.manager.addParameter("facet",!0),this.facet.date!==undefined?(this.manager.addParameter("facet.date",this.field,o),e.extend(s,{"date.start":null,"date.end":null,"date.gap":null,"date.hardend":null,"date.other":null,"date.include":null})):this.facet.range!==undefined?(this.manager.addParameter("facet.range",this.field,o),e.extend(s,{"range.start":null,"range.end":null,"range.gap":null,"range.hardend":null,"range.other":null,"range.include":null})):(this.facet.field=!0,this.statistics&&(o.stats=this.id+"_stats",Solr.facetStats(this.manager,o.stats,this.statistics)),this.manager.addParameter("facet.field",this.field,o)),s=e.common(this.facet,s),e.each(s,function(e,t){a.manager.addParameter("f."+a.field+".facet."+t,e)})}},addValue:function(e,t){this.multivalue||this.clearValues();var r;if(!this.aggregate||!(r=this.manager.findParameters(this.fqName,this.fqRegExp)).length)return this.manager.addParameter(this.fqName,this.fqValue(e,t),this.domain);var n=this.manager.getParameter(this.fqName,r[0]),a=this.fqParse(n.value),i=!1;Array.isArray(e)||(e=[e]);for(var s,o=0,u=e.length;o<u;++o)a!=(s=e[o])&&(Array.isArray(a)&&a.indexOf(s)>=0||("string"==typeof a&&(a=[a]),a.push(s),i=!0));return!!i&&(n.value=this.fqValue(a,t),!0)},removeValue:function(e){if(this.multivalue){var t=this,r=!1;return this.manager.removeParameters(this.fqName,function(n){var a,i;return!!n.value.match(t.fqRegExp)&&(t.aggregate?(a=t.fqParse(n.value),Array.isArray(e)||(e=[e]),Array.isArray(a)?!(a=a.filter(function(t){return-1==e.indexOf(t)||(r=!0,!1)})).length||(1==a.length&&(a=a[0]),n.value=t.fqValue(a),!1):(r=r||(i=e.indexOf(a)>=0),i)):(r=r||(i=n.value.indexOf(Solr.facetValue(e))>=0),i))}),r}return this.clearValues()},hasValue:function(e){for(var t,r=this.manager.findParameters(this.fqName,this.fqRegExp),n=0,a=r.length;n<a;++n)if(t=this.manager.getParameter(this.fqName,r[n]),this.fqParse(t.value).indexOf(e)>-1)return!0;return!1},clearValues:function(){return this.manager.removeParameters(this.fqName,this.fqRegExp)},getFacetCounts:function(e){var t;if(!0===this.useJson)return null==e&&(e=this.manager.response.facets),e.count>0?e[this.id].buckets:[];if(null==e&&(e=this.manager.response.facet_counts),this.facet.field!==undefined?t="facet_fields":this.facet.date!==undefined?t="facet_dates":this.facet.range!==undefined&&(t="facet_ranges"),t!==undefined)switch(this.manager.getParameter("json.nl").value){case"map":return this.getFacetCountsMap(e,t);case"arrarr":return this.getFacetCountsArrarr(e);default:return this.getFacetCountsFlat(e)}throw'Cannot get facet counts unless one of the following properties is set to "true" on widget "'+this.id+'": "facet.field", "facet.date", or "facet.range".'},getFacetCountsMap:function(e,t){var r=[];for(var n in e[t][this.id])r.push({val:n,count:parseInt(e[t][this.id][n])});return r},getFacetCountsArrarr:function(e,t){for(var r=[],n=0,a=e[t][this.id].length;n<a;n++)r.push({val:e[t][this.id][n][0],count:parseInt(e[t][this.id][n][1])});return r},getFacetCountsFlat:function(e,t){for(var r=[],n=0,a=e[t][this.id].length;n<a;n+=2)r.push({val:e[t][this.id][n],count:parseInt(e[t][this.id][n+1])});return r},fqValue:function(e,t){return(t?"-":"")+this.field+":"+Solr.facetValue(e)},fqParse:function(e){var t=e.match(this.fqRegExp);return null!=t?Solr.parseFacet(t[1]):null}},Solr.rangeValue=function(e){return Array.isArray(e)?"["+Solr.escapeValue(e[0]||"*")+" TO "+Solr.escapeValue(e[1]||"*")+"]":Solr.escapeValue(e)},Solr.parseRange=function(e){var t=e.match(/(-?)([^\s:]+):\s*\[\s*([^\s]+)\s+TO\s+([^\s]+)\s*\]/);return t?{field:t[2],exclude:!!t[1],value:[t[3],t[4]]}:null},Solr.Ranging=function(t){this.field=this.id=null,e.extend(!0,this,e.common(t,this)),this.manager=null,this.fqRegExp=new RegExp("^-?"+this.field+":\\s*\\[\\s*([^\\s])+\\s+TO\\s+([^\\s])+\\s*\\]"),this.fqName=this.useJson?"json.filter":"fq",this.exclusion&&(this.domain=e.extend(!0,this.domain,{tag:this.id+"_tag"}))},Solr.Ranging.prototype={multirange:!1,exclusion:!1,domain:null,useJson:!1,domain:null,init:function(t){e.pass(this,Solr.Ranging,"init",t),this.manager=t},addValue:function(e,t){return this.clearValues(),this.manager.addParameter(this.fqName,this.fqValue(e,t),this.domain)},removeValue:function(e){return this.clearValues()},hasValue:function(e){return null!=this.manager.findParameters(this.fqName,this.fqRegExp)},clearValues:function(){return this.manager.removeParameters(this.fqName,this.fqRegExp)},fqValue:function(e,t){return(t?"-":"")+this.field+":"+Solr.rangeValue(e)},fqParse:function(e){var t=e.match(this.fqRegExp);return t?(t.shift(),t):null}};var u=e(Solr.Faceting);Solr.Pivoting=function(t){e.extend(!0,this,e.common(t,this)),this.manager=null,this.faceters={},this.id=t.id,this.settings=t,this.rootId=null},Solr.Pivoting.prototype={pivot:null,useJson:!1,statistics:null,domain:null,addFaceter:function(e,t){return new u(e)},init:function(t){e.pass(this,Solr.Pivoting,"init",t),this.manager=t;var r=this.statistics;if(!this.useJson){var n={};r&&(n.stats=this.id+"_stats",Solr.facetStats(this.manager,n.stats,r),r=null),this.exclusion&&(n.ex=this.id+"_tag"),this.manager.addParameter("facet.pivot",this.pivot.map(function(e){return"string"==typeof e?e:e.field}).join(","),n)}for(var a="json",i=0,s=this.pivot.length;i<s;++i){var o=this.pivot[i],u=e.extend(!0,{},this.settings,"string"==typeof o?{id:o,field:o,disabled:!0}:o);a+=".facet."+u.id,this.useJson&&(u.jsonLocation=a),null==this.rootId&&(this.rootId=u.id),u.exclusion=!1,null==o.nesting&&i>0&&delete u.nesting,u.statistics=r,(this.faceters[u.id]=this.addFaceter(u,i)).init(t)}},getPivotEntry:function(e){var t=this.pivot[e];return t===undefined?null:"object"==typeof t?t:{id:t,field:t}},getFaceterEntry:function(e){var t=this.pivot[e];return this.faceters["string"==typeof t?t:t.id]},getPivotCounts:function(e){if(!0===this.useJson)return null==e&&(e=this.manager.response.facets),e.count>0?e[this.rootId].buckets:[];throw null==e&&(e=this.manager.response.pivot),{error:"Not supported for now!"}},addValue:function(e,t){var r=this.parseValue(e);return this.faceters[r.id].addValue(r.value,t)},removeValue:function(e){var t=this.parseValue(e);return this.faceters[t.id].removeValue(t.value)},clearValues:function(){e.each(this.faceters,function(e){e.clearValues()})},hasValue:function(e){var t=this.parseValue(e);return null!=t.id&&this.faceters[t.id].hasValue(t.value)},parseValue:function(e){var t=e.match(/^(\w+):(.+)$/);return t&&this.faceters[t[1]]!==undefined?{value:t[2],id:t[1]}:{value:e}},fqParse:function(e){var t=this.parseValue(e),r=null;if(null!=t.id)r=this.faceters[t.id].fqParse(t.value);else for(var n in this.faceters)if(r=this.faceters[n].fqParse(t.value)){t.id=n;break}return Array.isArray(r)?r=r.map(function(e){return t.id+":"+e}):null!=r&&(r=t.id+":"+r),r}},Solr.Listing=function(t){e.extend(!0,this,e.common(t,this)),this.manager=null},Solr.Listing.prototype={nestingRules:null,listingFields:["*"],init:function(t){e.pass(this,Solr.Listing,"init",t),e.each(this.nestingRules,function(e,r){t.addParameter("fl","[child parentFilter="+e.field+":"+e.parent+" childFilter="+e.field+":"+r+" limit="+e.limit+"]")}),e.each(this.listingFields,function(e){t.addParameter("fl",e)})}},"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=Solr:(this.Solr=Solr,"function"==typeof define&&define.amd&&define(Solr))}(asSys);